---
title: 【草稿】借助云存储，让大图识别转换真正加速
---

上一期时序图

![](https://n1image.hjfile.cn/res7/2020/02/18/71aee60f54119b0f6055b150be12be1e.jpg)


人脸识别时，需要原图的0.1倍质量的图片即可，也就是，图片模糊一些是OK的。

从原图657KB，经过微信压缩，经过base64，大小约为100KB，进过腾讯云人脸识别后，实际耗时约为**3秒左右**

**目标是小图，一次性识别时，可用base64**



那么，再看本期需求？？？？

先看效果图

（需要一张图）

* 人脸五官识别：原图的0.1倍质量即可
  * 识别时就立马开始执行
  * 图片经过压缩并转换为base64，大小约为原图的七分之一
  * 网络传递base64数据，总的时间约为3秒
* 人像年龄变化：原图大小
  * 多次转换需要，如童年、青年、老年
  * 方案一：直接传递base64数据
    * 需要在云函数、腾讯云处都需要传递原图的1.33倍大小的数据
    * 实际使用时间约为7秒，而且受网络环境影响
  * 方案二：借助云存储
    * 人脸五官识别后，就将原图上传到云存储，获取fileID
    * 转换时，云函数上传fileID
    * 在云环境里面，通过fileID获取图片临时地址，
    * 腾讯云使用图片临时地址来转换图片

（第二个图）

![](https://n1image.hjfile.cn/res7/2020/02/18/71aee60f54119b0f6055b150be12be1e.jpg)




2张时序图


说明人脸识别与人像转换对图片要求的差异：图片质量0.1与1的区别，不清晰与原图的区别

图片转buffer转base64，体积为原来的1.33倍

多次网络传输base64数据，请求量大

反复识别，存储保存原始图片，统一服务器请求，这样更快？
